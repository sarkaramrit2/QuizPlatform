<%@ include file="/tld_includes.jsp"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<tiles:insertTemplate template="/views/layout/adminBaseTheme.jsp">
	<tiles:putAttribute name="title" value="Cache Manager" />
	<tiles:putAttribute name="head">
	</tiles:putAttribute>
	<tiles:putAttribute name="deferredScript">
		<script type="text/javascript">
			function submit() {
				var component = $('#component option:selected').attr('type');
				var ajaxUrl = "/admin/cacheManager/submit?component="
						+ component;

				$.ajax({
					url : ajaxUrl,
					type : "POST",
					dataType : 'json',
					success : function(data) {
						var status = data['status'];
						var msg = data['message'];
						if (status == "success") {
							addSuccessMessage(msg);
						} else {
							addError(msg);
						}

					}
				});
			}
			function errorValidation(divId) {
				divId.removeClass("warning");
				divId.removeClass("info");
				divId.removeClass("success");
				divId.addClass("error");
			}

			function successValidation(divId) {
				divId.removeClass("info");
				divId.removeClass("error");
				divId.removeClass("warning");
				divId.addClass("success");
			}
			function addError(message) {
				$("#message")
						.html(
								'<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><h4>Error!</h4>'
										+ message + '</div>');
			}

			function addMessage(message) {
				$("#message")
						.html(
								'<div class="alert alert-info alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><h4>Info:</h4>'
										+ message + '</div>');
			}

			function addSuccessMessage(message) {
				$("#message")
						.html(
								'<div class="alert alert-success alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><h4>Success!</h4>'
										+ message + '</div>');
			}

			function removeMessage() {
				$("#message").html('');
			}
		</script>
	</tiles:putAttribute>
	<tiles:putAttribute name="body">
		<div style="margin-left: 10px; margin-right: 10px">
			<c:set var="title" value="Cache Manager" />
			<%@include file="brand.jsp"%>
			<div id="message"></div>

			<div class="form-group">
				<label class="control-label col-lg-2" for="component">Select
					Component</label>
				<div class="col-lg-3">
					<select id="component" class="form-control">
						<option type="all">All</option>
						<<!-- option type="searcher">Searcher(s)</option>
						<option type="suggester">Suggester(s)</option> -->
						<option type="searchIndexer">Search Indexer(s)</option>
						<option type="suggesterIndexer">Suggester Indexer</option>
						<option type="admin">Search Admin</option>
					</select>
				</div>
			</div>

			<div class="form-group">
				<div class="col-lg-3 col-lg-offset-2">
					<button class="btn btn-primary btn-lg" type="button"
						id="reload-submit" onclick="submit();">Submit</button>
				</div>
			</div>
		</div>

	</tiles:putAttribute>

</tiles:insertTemplate>
