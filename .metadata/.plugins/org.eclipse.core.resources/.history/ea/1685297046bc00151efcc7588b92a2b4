

<body onload="clearURL()">
	<div ng-app="myApp" ng-controller="manageTagsController" ng-init="initializeController()">
	
	<form name="pogForm" class="form-horizontal" novalidate>
		<div class="form-group" >
			<label class="col-xs-2 control-label">POG ID:<span class="required">*</span> </label>
			<div class="col-xs-3" ng-class="{ 'has-error' : pogForm.pogId.$invalid && !pogForm.pogId.$pristine }">
				<input name="pogId" ng-disabled="disableFlag" class="form-control" type="text" ng-model="overrideTags.pogId" required />
				<span ng-show="!pogForm.pogId.$pristine && pogForm.pogId.$invalid">
					<p ng-show="pogForm.pogId.$error.required" class="help-block">Required!</p>
				</span>
			</div>
			
			<!-- <label ng-hide="!overrideTags.tags.length" class="col-xs-2 control-label">Queue Url:<span class="required">*</span> </label>
			<div class="col-xs-3" ng-hide="!overrideTags.tags.length" ng-class="{ 'has-error' : pogForm.url.$invalid && !pogForm.url.$pristine }">
				<input name="url"  class="form-control" type="text" ng-model="queueUrl" required />
				<span ng-show="!pogForm.url.$pristine && pogForm.url.$invalid">
					<p ng-show="pogForm.url.$error.required" class="help-block">Required!</p>
				</span>
			</div> -->
		</div>
		<div class="form-group">
			<div class="col-xs-3 col-lg-offset-2">
				<button class="btn btn-primary" type="button" ng-disabled="disableFlag || pogForm.pogId.$invalid" ng-click="submitPOG();" id="submitPOG">Submit</button>
				<button class="btn btn-primary" type="button" ng-click="resetPOG();" id="resetPOG">Reset</button>
			</div>
			<div class="col-xs-3 col-lg-offset-2">
			<!-- ng-hide="!overrideTags.tags.length" -->
				<button class="btn btn-primary" type="button" ng-hide="!disableFlag" ng-disabled="pogForm.url.$invalid" ng-click="indexPOG();" id="indexPOG">Index</button>
			</div>
		</div>
	</form>
	<div ng-show="disableFlag">
	    <table ng-table="tableParams" class="table table-condensed table-bordered table-striped" show-filter="true">
	        <thead>
	        <tr>
	            <th ng-repeat="column in columns" ng-show="column.visible"
	                class="sortable" ng-class="{
	                    'sort-asc': tableParams.isSortBy(column.field, 'asc'),
	                    'sort-desc': tableParams.isSortBy(column.field, 'desc')
	                  }"
	                ng-click="tableParams.sorting(column.field, tableParams.isSortBy(column.field, 'asc') ? 'desc' : 'asc')">
	                {{column.title}}
	            </th>
	            <th><button class="btn btn-primary btn-sm" ng-click="cancelTag();openAddTagModal();">Add/Delete</button>
	            <button ng-hide="!tags.length" class="btn btn-primary btn-sm" ng-click="openViewTagModal();">View Tags</button></th>
	            
	        </tr>
	        <tr class="ng-table-filters" ng-init="tableParams">
	            <th ng-repeat="column in columns" ng-show="column.visible" class="filter">
	                <div ng-repeat="(name, filter) in column.filter">
	                    <div ng-if="column.filterTemplateURL" ng-show="column.filterTemplateURL">
	                        <div ng-include="column.filterTemplateURL"></div>
	                    </div>
	                    <div ng-if="!column.filterTemplateURL" ng-show="!column.filterTemplateURL">
	                        <div ng-include="'ng-table/filters/' + filter + '.html'"></div>
	                    </div>
	                </div>
	            </th>
	        </tr>
	        </thead>
	         <tbody>
		        <tr ng-repeat="row in $data">
		            <td ng-repeat="column in columns" ng-show="column.visible" sortable="column.field" >
		                <span ng-if="editId!=$parent.$index && column.type!='date'">{{row[column.field] }} </span>
		                <span ng-if="editId!=$parent.$index && column.type=='date'">{{row[column.field] | date:'dd/MM/yyyy HH:mm:ss'}} </span>
	                	<div ng-if="editId===$parent.$index">
	                		<input ng-if="!column.type" class="form-control" type="text" ng-model="row[column.field]"/>
	                		<input ng-if="column.type=='number'" class="form-control" type="number" ng-model="row[column.field]"/>
	                		<select ng-if="column.type=='select'" class="form-control" ng-model="row[column.field]" ng-options="operation as operation for operation in operations"></select>

							<div class="dropdown" ng-if="column.type=='date'" style="width:250px;"  >
								<a class="dropdown-toggle" id="{{column.field+$parent.$index}}" role="button"
									data-toggle="dropdown" data-target="#" href="#">
									<div class="input-group">
										<input type="text" class="form-control" data-date-time-input="DD/MM/YYYY HH:mm:ss" readonly
											data-ng-model="row[column.field]"><span
											class="input-group-addon"><i
											class="glyphicon glyphicon-calendar"></i></span>
									</div>
								</a>
								<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
									<datetimepicker data-ng-model="row[column.field]"
										data-datetimepicker-config="{ dropdownSelector: '{{'#'+column.field+$parent.$index}}' }" />
								</ul>
							</div>


						</div>
		            </td>
		            <td>
		            	<button class="btn btn-default btn-sm" ng-disabled="editId!=-1 && editId!=$index" ng-if="editId!=$index" ng-click="editTag($index);"><span class="glyphicon glyphicon-pencil"></span></button>
		            	<button class="btn btn-danger btn-sm" ng-disabled="editId!=-1 && editId!=$index" ng-if="editId!=$index" ng-click="deleteTag(row);"><span class="glyphicon glyphicon-trash"></span></button>
		            	<button class="btn btn-primary btn-sm" ng-if="editId===$index" ng-click="updateTag(row);"><span class="glyphicon glyphicon-ok"></span></button>
		            	<button class="btn btn-default btn-sm" ng-if="editId===$index" ng-click="editTag(-1);cancelTag();"><span class="glyphicon glyphicon-remove"></span></button>
		            </td>
		        </tr>
	        </tbody>
	    </table> 
	</div>
	<script type="text/ng-template" id="addTag.html">
        <div class="modal-header">
            <h3 class="modal-title">Add/Delete Tag</h3>
        </div>
        <div class="modal-body">
			
				<form name="tagForm" class="form-horizontal" novalidate>
					 <div class="form-group">
                        <label class="col-xs-3 control-label">POG ID:</label>
                        <div class="col-xs-5">
							<span>{{overrideTags.pogId }} </span>
                        </div>
                    </div>

                    <div class="form-group" >
                        <label class="col-xs-3 control-label">Operation:<span class="required">*</span></label>
                        <div class="col-xs-5">
							<select class="form-control"  ng-model="overrideTag.operation" ng-options="operation as operation for operation in operations">
							</select>
                            <!--input type="text" class="form-control" name="operation" ng-model="overrideTag.operation"/-->
                        </div>
                    </div>

					<div class="form-group">
                        <label class="col-xs-3 control-label">Tag Name:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : (tagForm.tagName.$invalid && !tagForm.tagName.$pristine || value_error) }">
                            <input type="text" name="tagName" class="form-control" ng-model="overrideTag.value" required ng-minlength="2" ng-maxlength="50"/>
							<span ng-show="!tagForm.tagName.$pristine && tagForm.tagName.$invalid">
								<p ng-show="tagForm.tagName.$error.required" class="help-block">Required!</p>
								<p ng-show="tagForm.tagName.$error.maxlength" class="help-block">Too Large!</p>
								<p ng-show="tagForm.tagName.$error.minlength" class="help-block">Too Short!</p>
							</span>
							<span ng-show="value_error"><p  class="help-block">{{error}}</p></span>
                        </div>
                    </div>

                    <div class="form-group" ng-hide="overrideTag.operation!='add'">
                        <label class="col-xs-3 control-label">Boost Value:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : tagForm.boostValue.$invalid && !tagForm.boostValue.$pristine || boost_error }">
                            <input type="number" class="form-control" name="boostValue" ng-model="overrideTag.boost" required />
							<span ng-show="!tagForm.boostValue.$pristine && tagForm.boostValue.$invalid">	
								<p ng-show="tagForm.boostValue.$error.required" class="help-block">Required!</p>
								<p ng-show="tagForm.boostValue.$error.number" class="help-block">Not valid number!</p>
							</span>
							<span ng-show="boost_error"><p  class="help-block">{{error}}</p></span>
                        </div>
                    </div>
				

					<div class="form-group" ng-hide="overrideTag.operation!='add'">
                        <label class="col-xs-3 control-label">Start Date:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : start_date_error }">
							<div class="dropdown">
								<a class="dropdown-toggle" id="start_date_id" role="button" data-toggle="dropdown" data-target="#" href="#">
									<div class="input-group">
										<input type="text" name="start_date" class="form-control" data-date-time-input="DD/MM/YYYY HH:mm:ss" readonly
											data-ng-model="overrideTag.start_date" required>
										<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
									</div>
								</a>
								<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
									<datetimepicker data-ng-model="overrideTag.start_date"
										data-datetimepicker-config="{ dropdownSelector: '#start_date_id' }" />
								</ul>
							</div>
							<span ng-show="start_date_error"><p  class="help-block">{{error}}</p></span>
                        </div>
                    </div>

					<div class="form-group" ng-hide="overrideTag.operation!='add'">
                        <label class="col-xs-3 control-label">End Date:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : end_date_error }">
							<div class="dropdown">
								<a class="dropdown-toggle" id="end_date_id" role="button" data-toggle="dropdown" data-target="#" href="#">
									<div class="input-group">
										<input type="text" name="end_date" class="form-control" data-date-time-input="DD/MM/YYYY HH:mm:ss" readonly
											data-ng-model="overrideTag.end_date" required>
										<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
									</div>
								</a>
								<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
									<datetimepicker data-ng-model="overrideTag.end_date"
										data-datetimepicker-config="{ dropdownSelector: '#end_date_id' }" />
								</ul>
							</div>
							<span ng-show="end_date_error"><p  class="help-block">{{error}}</p></span>
                        </div>
                    </div>
                
				</form>
            </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="addTag()" ng-disabled="(((tagForm.tagName.$invalid 
				|| tagForm.boostValue.$invalid || tagForm.start_date.$invalid || tagForm.end_date.$invalid) && overrideTag.operation=='add')  || (overrideTag.operation=='delete' && tagForm.tagName.$invalid))" >Save</button>
            <button class="btn btn-warning" ng-click="closeAddTagModal()">Cancel</button>
        </div>
	</script>
	
	<script type="text/ng-template" id="viewTag.html">
        <div class="modal-header">
            <h3 class="modal-title">View Tags</h3>
        </div>
        <div class="modal-body">
			
				<table ng-table="tableParams" class="table table-condensed table-bordered table-striped" show-filter="true">
			<tr>
            <th ng-repeat="column in tagColumns" ng-show="column.visible" class="sortable" ng-class="{
                    'sort-asc': tableParams.isSortBy(column.field, 'asc'),
                    'sort-desc': tableParams.isSortBy(column.field, 'desc')
                  }"
                ng-click="tableParams.sorting(column.field, tableParams.isSortBy(column.field, 'asc') ? 'desc' : 'asc')">
                {{column.title}}
            </th>
            
        </tr>
        <tr class="ng-table-filters" ng-init="tableParams">
            <th ng-repeat="column in tagColumns" ng-show="column.visible" class="filter">
                <div ng-repeat="(name, filter) in column.filter">
                    <div ng-if="column.filterTemplateURL" ng-show="column.filterTemplateURL">
                        <div ng-include="column.filterTemplateURL"></div>
                    </div>
                    <div ng-if="!column.filterTemplateURL" ng-show="!column.filterTemplateURL">
                        <div ng-include="'ng-table/filters/' + filter + '.html'"></div>
                    </div>
                </div>
            </th>
        </tr>
	        <tr ng-repeat="row in $data">
	            <td ng-repeat="column in tagColumns" ng-show="column.visible" sortable="column.field" >
	                <span>{{row[column.field] }} </span>
	            </td>
	        </tr>
    </table> 
            </div>
        <div class="modal-footer">
            <button class="btn btn-warning" ng-click="closeViewTagModal()">Cancel</button>
        </div>
	</script>
	</div>
</body>