	
	<div ng-controller="manageQulController" ng-init="initializeController()">
	
	<form name="queryForm" class="form-horizontal" novalidate>
		<div class="form-group" >
			<label class="col-xs-2 control-label">Search Query:<span class="required">*</span> </label>
			<div class="col-xs-3" ng-class="{ 'has-error' : queryForm.query.$invalid && !queryForm.query.$pristine }">
				<input name="query" ng-disabled="disableFlag" class="form-control" type="text" ng-model="query.query" required />
				<span ng-show="!queryForm.query.$pristine && queryForm.query.$invalid">
					<p ng-show="queryForm.query.$error.required" class="help-block">Required!</p>
				</span>
			</div>
			
		</div>
		<div class="form-group">
			<div class="col-xs-3 col-lg-offset-2">
				<button class="btn btn-primary" type="button" ng-disabled="disableFlag || queryForm.query.$invalid" ng-click="submitQuery();" id="submitQuery">Submit</button>
				<button class="btn btn-primary" type="button" ng-click="resetQuery();" id="resetQuery">Reset</button>
				<button class="btn btn-primary" type="button" ng-hide="!query.values.length" ng-click="indexQuery();" id="indexQuery">Save to Cache</button>
			</div>
		</div>
	</form>
	<div ng-show="disableFlag">
	    <table ng-table="tableParams" class="table table-condensed table-bordered table-striped" show-filter="true">
	        <thead>
	        <tr>
	            <th ng-repeat="column in columns" ng-show="column.visible"
	                class="sortable" ng-class="{
	                    'sort-asc': tableParams.isSortBy(column.field, 'asc'),
	                    'sort-desc': tableParams.isSortBy(column.field, 'desc')
	                  }"
	                ng-click="tableParams.sorting(column.field, tableParams.isSortBy(column.field, 'asc') ? 'desc' : 'asc')">
	                {{column.title}}
	            </th>
	            <th><button class="btn btn-primary btn-sm" ng-click="openAddQueryModal();">Add</button></th>
	            
	        </tr>
	        <tr class="ng-table-filters" ng-init="tableParams">
	            <th ng-repeat="column in columns" ng-show="column.visible" class="filter">
	                <div ng-repeat="(name, filter) in column.filter">
	                    <div ng-if="column.filterTemplateURL" ng-show="column.filterTemplateURL">
	                        <div ng-include="column.filterTemplateURL"></div>
	                    </div>
	                    <div ng-if="!column.filterTemplateURL" ng-show="!column.filterTemplateURL">
	                        <div ng-include="'ng-table/filters/' + filter + '.html'"></div>
	                    </div>
	                </div>
	            </th>
	        </tr>
	        </thead>
	         <tbody>
		        <tr ng-repeat="row in $data">
		            <td ng-repeat="column in columns" ng-show="column.visible" sortable="column.field" >
		                <span ng-if="editId!=$parent.$index">{{row[column.field] }} </span>
	                	<div ng-if="editId===$parent.$index">
	                		<input ng-if="!column.type" class="form-control" type="text" ng-model="row[column.field]"/>
	                		<input ng-if="column.type=='number'" class="form-control" type="number" ng-model="row[column.field]"/>
	                	</div>
		            </td>
		            <td>
		            	<button class="btn btn-default btn-sm" ng-if="editId!=$index" ng-click="editQuery($index);"><span class="glyphicon glyphicon-pencil"></span></button>
		            	<button class="btn btn-danger btn-sm" ng-if="editId!=$index" ng-click="deleteQuery(row);"><span class="glyphicon glyphicon-trash"></span></button>
		            	<button class="btn btn-primary btn-sm" ng-if="editId===$index" ng-click="updateQuery(row);"><span class="glyphicon glyphicon-ok"></span></button>
		            	<button class="btn btn-default btn-sm" ng-if="editId===$index" ng-click="editQuery(-1);cancelQuery();"><span class="glyphicon glyphicon-remove"></span></button>
		            </td>
		        </tr>
	        </tbody>
	    </table> 
	</div>
	<script type="text/ng-template" id="addQuery.html">
        <div class="modal-header">
            <h3 class="modal-title">Add Query Combination</h3>
        </div>
        <div class="modal-body">
			
				<form name="queryForm" class="form-horizontal" novalidate>
					 <div class="form-group">
                        <label class="col-xs-3 control-label">Query:</label>
                        <div class="col-xs-5">
							<span>{{query.query }} </span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-xs-3 control-label">Context:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : queryForm.context.$invalid && !queryForm.context.$pristine }">
                            <input type="text" name="context" class="form-control" ng-model="innerQuery.context" required />
							<span ng-show="!queryForm.context.$pristine && queryForm.context.$invalid">
								<p ng-show="queryForm.context.$error.required" class="help-block">Required!</p>
							</span>
                        </div>
                    </div>
					<div class="form-group">
                        <label class="col-xs-3 control-label">Label:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : queryForm.label.$invalid && !queryForm.label.$pristine }">
                            <input type="text" name="label" class="form-control" ng-model="innerQuery.label" required />
							<span ng-show="!queryForm.label.$pristine && queryForm.label.$invalid">
								<p ng-show="queryForm.label.$error.required" class="help-block">Required!</p>
							</span>
                        </div>
                    </div>
					<div class="form-group">
                        <label class="col-xs-3 control-label">Word:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : queryForm.word.$invalid && !queryForm.word.$pristine }">
                            <input type="text" name="word" class="form-control" ng-model="innerQuery.word" required />
							<span ng-show="!queryForm.word.$pristine && queryForm.word.$invalid">
								<p ng-show="queryForm.word.$error.required" class="help-block">Required!</p>
							</span>
                        </div>
                    </div>
                    <div class="form-group" >
                        <label class="col-xs-3 control-label">Score:<span class="required">*</span></label>
                        <div class="col-xs-5" ng-class="{ 'has-error' : queryForm.score.$invalid && !queryForm.score.$pristine }">
                            <input type="number" class="form-control" name="score" ng-model="innerQuery.score" required/>
							<span ng-show="!queryForm.score.$pristine && queryForm.score.$invalid">	
								<p ng-show="queryForm.score.$error.required" class="help-block">Required!</p>
							</span>
                        </div>
                    </div>
					
                </form>
            </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="addQuery()" ng-disabled="queryForm.context.$invalid || queryForm.score.$invalid || queryForm.label.$invalid || queryForm.word.$invalid">Save</button>
            <button class="btn btn-warning" ng-click="closeAddQueryModal()">Cancel</button>
        </div>
	</script>
	</div>

